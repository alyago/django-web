(function(){var d=$.event.props,a=d.length,b=[];while(a--){var c=d[a];if(c!="layerX"&&c!="layerY"){b.push(c)}}$.event.props=b}());SH.autocomplete={};var current=0;$(function(a){if(kw_ac==true){$("#f_keywords").bind("click keyup",function(b){SH.autocomplete.search.ac($(this),b)})}if(lc_ac==true){$("#f_location").bind("click keyup",function(b){SH.autocomplete.search.ac($(this),b)})}});SH.autocomplete.search=function(){var f="http://"+window.location.hostname+"/suggest/";var a="";var e="http://"+window.location.hostname+"/a/catalog/geoipinfo";var c="f_keywords";var b="f_location";var g=0;var d=false;return{ac:function(j,h){if(h.keyCode!=40&&h.keyCode!=38){current++;if(j.attr("id")==c){a=encodeURI(f+"keyword?term="+j.val());this.create_dropdown(j)}if(j.attr("id")==b){a=f+"location?";var i=j.data("atc_area");if(i==undefined){$.get(e,function(k){i=k;j.data("atc_area",k)})}a+=encodeURI("ll="+i+"&term="+j.val());this.create_dropdown(j)}}else{if(h.keyCode==40){this.nav_dropdown(j,1)}if(h.keyCode==38){this.nav_dropdown(j,-1)}}j.blur(function(){if(!d){$("#"+j.attr("id")+"_atc_dropdown").remove();g=0}})},nav_dropdown:function(h,i){var j=$(".dropdown_item");if($(".dropdown_item_hover").length==0){g=-1}if(i<0&&g!=-1){if(g!=0){g--}}else{if(i>0){if(g!=j.length-1){g++}}}j.removeClass("dropdown_item_hover");j.eq(g).addClass("dropdown_item_hover");h.val(j.eq(g).text())},create_dropdown:function(i){var j=i.attr("id");var h=j+"_atc_dropdown";var l=$("#"+h);var k=i.width()+4;if($.trim(i.val())==""&&l.length!=0){l.hide()}else{if($.trim(i.val())!=""){$.ajax({url:a,data:{current:current},success:function(m){if(m[0]==current){if(m[1].length>0){var n=[];n.push('<div id="'+h+'" class="atc_dropdown" style="width:'+k+'px;">');$.each(m[1],function(p){n.push('<div class="dropdown_item" name="'+p+'"><a>'+m[1][p]+"</a></div>")});n.push("</div>");n=n.join("");var o=document.createElement("DIV");o.innerHTML=n;if(l.length==0){i.after(n)}else{l.replaceWith(n)}$(".dropdown_item").hover(function(){$(".dropdown_item_hover").removeClass("dropdown_item_hover");$(this).addClass("dropdown_item_hover");g=parseInt($(this).attr("name"))},function(){$(this).removeClass("dropdown_item_hover")});$(".dropdown_item").mousedown(function(){d=true});$(".dropdown_item").mouseup(function(){i.val($(this).text());$(this).parent().hide();d=false;i.focus()})}else{if(l.length!=0){l.hide()}}}},dataType:"json"})}}}}}();