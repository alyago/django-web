(function(){var d=$.event.props,a=d.length,b=[];while(a--){var c=d[a];if(c!="layerX"&&c!="layerY"){b.push(c)}}$.event.props=b}());SH.autocomplete={};var current=0;SH.autocomplete.search=function(){var d="http://"+window.location.hostname+"/suggest/";var a="";var c="http://"+window.location.hostname+"/a/catalog/geoipinfo";var g="q";var f="l";var e=0;var b=false;return{bind:function(h){if(kw_ac==true){$(".id_f_keywords",h).bind("click keyup",function(i){SH.autocomplete.search.ac($(this),i)})}if(lc_ac==true){$(".id_f_location",h).bind("click keyup",function(i){SH.autocomplete.search.ac($(this),i)})}},unbind:function(h){if(kw_ac==true){$(".id_f_keywords",h).unbind("click keyup")}if(lc_ac==true){$(".id_f_location",h).unbind("click keyup")}},ac:function(j,h){if(h.keyCode!=40&&h.keyCode!=38&&h.keyCode!=13){current++;if(j.attr("name")==g){a=encodeURI(d+"keyword?term="+j.val());this.create_dropdown(j)}if(j.attr("name")==f){a=d+"location?";var i=j.data("atc_area");if(i==undefined){$.get(c,function(k){i=k;j.data("atc_area",k)})}a+=encodeURI("ll="+i+"&term="+j.val());this.create_dropdown(j)}}else{if(h.keyCode==40){this.nav_dropdown(j,1)}if(h.keyCode==38){this.nav_dropdown(j,-1)}if(h.keyCode==13){j.blur()}}j.blur(function(){if(!b){$("#"+j.attr("name")+"_atc_dropdown").remove();e=0}})},nav_dropdown:function(h,i){var j=$(".dropdown_item");if($(".dropdown_item_hover").length==0){e=-1}if(i<0&&e!=-1){if(e!=0){e--}}else{if(i>0){if(e!=j.length-1){e++}}}j.removeClass("dropdown_item_hover");j.eq(e).addClass("dropdown_item_hover");h.val(j.eq(e).text())},create_dropdown:function(j){var i=j.attr("name");var h=i+"_atc_dropdown";var l=$("#"+h);var k=j.outerWidth();if($.trim(j.val())==""&&l.length!=0){l.hide()}else{if($.trim(j.val())!=""){$.ajax({url:a,data:{current:current},success:function(m){if(m[0]==current){if(m[1].length>0){var n=[];n.push('<div id="'+h+'" class="atc_dropdown" style="width:'+k+'px;">');$.each(m[1],function(o){n.push('<div class="dropdown_item" name="'+o+'"><a>'+m[1][o]+"</a></div>")});n.push("</div>");n=n.join("");if(l.length==0){j.after(n)}else{l.replaceWith(n)}$(".dropdown_item").hover(function(){$(".dropdown_item_hover").removeClass("dropdown_item_hover");$(this).addClass("dropdown_item_hover");e=parseInt($(this).attr("name"))},function(){$(this).removeClass("dropdown_item_hover")});$(".dropdown_item").mousedown(function(){b=true});$(".dropdown_item").mouseup(function(){j.val($(this).text());$(this).parent().hide();b=false;j.focus()})}else{if(l.length!=0){l.hide()}}}},dataType:"json"})}}}}}();